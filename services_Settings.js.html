<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>services/Settings.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="https://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <li class="nav-link nav-home-link"><a href="index.html">Home</a></li><li class="nav-heading">Classes</li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="NotificationService.html">NotificationService</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="NotificationService.html#.createNotificationTitle">createNotificationTitle</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="NotificationService.html#browserNotify">browserNotify</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="NotificationService.html#createNotificationBody">createNotificationBody</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="NotificationService.html#notifyUser">notifyUser</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="PomodoroSession.html">PomodoroSession</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="PomodoroSession.html#idle">idle</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="PomodoroSession.html#idleAtWorkSession">idleAtWorkSession</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="PomodoroSession.html#loadTimerSettings">loadTimerSettings</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="PomodoroSession.html#performLongBreakSession">performLongBreakSession</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="PomodoroSession.html#performPomodoroSession">performPomodoroSession</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="PomodoroSession.html#performShortBreakSession">performShortBreakSession</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="PomodoroSession.html#performWorkSession">performWorkSession</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="PomodoroSession.html#resetToWorkSession">resetToWorkSession</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="PomodoroSession.html#runLongBreak">runLongBreak</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="PomodoroSession.html#runShortBreak">runShortBreak</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="PomodoroSession.html#runWorkSession">runWorkSession</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="PomodoroSession.html#setSession">setSession</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="PomodoroSession.html#setSessionAndTime">setSessionAndTime</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="PomodoroSession.html#setTime">setTime</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="PomodoroSession.html#showFullTaskList">showFullTaskList</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="PomodoroSession.html#stopIdling">stopIdling</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="PomodoroSession.html#styleTimerForLongBreak">styleTimerForLongBreak</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="PomodoroSession.html#styleTimerForShortBreak">styleTimerForShortBreak</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="PomodoroSession.html#styleTimerForWorkSession">styleTimerForWorkSession</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="PomodoroSession.html#styleTimerUI">styleTimerUI</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="PomodoroSession.html#toggleSession">toggleSession</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="PomodoroSession.html#updateTaskList">updateTaskList</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="PomodoroSession.html#viewAll">viewAll</a></span></li><li class="nav-heading"><span class="nav-item-type type-class">C</span><span class="nav-item-name"><a href="Timer.html">Timer</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Timer.html#prepareTimerForStart">prepareTimerForStart</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Timer.html#run">run</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Timer.html#setTime">setTime</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Timer.html#step">step</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Timer.html#stop">stop</a></span></li><li class="nav-item"><span class="nav-item-type type-function">F</span><span class="nav-item-name"><a href="Timer.html#updateDocument">updateDocument</a></span></li><li class="nav-heading"><a href="global.html">Globals</a></li><li class="nav-item"><span class="nav-item-type type-member">M</span><span class="nav-item-name"><a href="global.html#instance">instance</a></span></li>
</nav>

<div id="main">
    
    <h1 class="page-title">services/Settings.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import PomodoroSession from './PomodoroSession.js';

let instance = null;

class Settings {
  constructor() {
    if (instance) return instance;
    instance = this;

    this.pomodoroSession = new PomodoroSession();

    this.loadSettings();

    this.hasLoadedIntoDOM = true;

    // binding methods to objects
    this.saveSettings = this.saveSettings.bind(this);
    this.cancelInput = this.cancelInput.bind(this);
    this.openSettings = this.openSettings.bind(this);
    this.closeSettings = this.closeSettings.bind(this);
    this.loadSettings = this.loadSettings.bind(this);
    this.updateSettings = this.updateSettings.bind(this);

    this.DOM_ELEMENTS = {
      settingsButton: document.getElementById('settings-button'),
      settingsModal: document.getElementById('settings-modal'),
      cancelButton: document.getElementById('cancel-button'),
      saveButton: document.getElementById('save-button'),
      pomDurationDrop: document.getElementById('pomo-duration-select'),
      shortBreakDrop: document.getElementById('short-duration-select'),
      longBreakDrop: document.getElementById('long-duration-select'),
      pomBeforeBreakDrop: document.getElementById('long-pomo-select'),
      pauseBeforeBox: document.getElementById('pause-before-breaks'),
      pauseAfterBox: document.getElementById('pause-after-breaks'),
      hideSecondsBox: document.getElementById('hide-seconds'),
    };

    this.DOM_ELEMENTS.settingsModal.style.display = 'none';

    return instance;
  }

  /**
   * Opens settings box UI
   */
  openSettings() {
    this.DOM_ELEMENTS.settingsModal.style.display = 'block';
    this.DOM_ELEMENTS.pomDurationDrop.value = this.workSessionDuration;
    this.DOM_ELEMENTS.shortBreakDrop.value = this.shortBreakDuration;
    this.DOM_ELEMENTS.longBreakDrop.value = this.longBreakDuration;
    this.DOM_ELEMENTS.pomBeforeBreakDrop.value = this.numSessionsBeforeLongBreak;
    this.DOM_ELEMENTS.pauseBeforeBox.checked = this.pauseBeforeBreak;
    this.DOM_ELEMENTS.pauseAfterBox.checked = this.pauseAfterBreak;
    this.DOM_ELEMENTS.hideSecondsBox.checked = this.hideSeconds;
  }

  /**
   * Closes settings box UI
   */
  closeSettings() {
    this.DOM_ELEMENTS.settingsModal.style.display = 'none';
  }

  /**
   * Cancel the input box
   */
  cancelInput() {
    this.closeSettings();
  }

  /**
   * Saves settings currently in settings boxes
   */
  saveSettings() {
    if (this.hasLoadedIntoDOM) {
      this.updateSettings();
    }
    this.closeSettings();
  }

  /**
   * Loads settings from localStorage
   */
  loadSettings() {
    this.hasLoadedIntoDOM = false;
    if (!localStorage.getItem('workSessionDuration')) {
      Settings.setDefaultValuesInStorage();
    }
    this.loadStoredInputValues();
    this.hasLoadedIntoDOM = true;
  }

  /**
   * Sets default values to local storage variables
   */
  static setDefaultValuesInStorage() {
    localStorage.setItem('workSessionDuration', 25);
    localStorage.setItem('shortBreakDuration', 5);
    localStorage.setItem('longBreakDuration', 30);
    localStorage.setItem('numSessionsBeforeLongBreak', 4);
    localStorage.setItem('pauseBeforeBreak', false);
    localStorage.setItem('pauseAfterBreak', true);
    localStorage.setItem('hideSeconds', false);
  }

  /**
   * Loads browser stored values to instance variables
   */
  loadStoredInputValues() {
    this.workSessionDuration = localStorage.getItem('workSessionDuration');
    this.shortBreakDuration = localStorage.getItem('shortBreakDuration');
    this.longBreakDuration = localStorage.getItem('longBreakDuration');
    this.numSessionsBeforeLongBreak = localStorage.getItem('numSessionsBeforeLongBreak');
    this.pauseBeforeBreak = localStorage.getItem('pauseBeforeBreak') === 'true';
    this.pauseAfterBreak = localStorage.getItem('pauseAfterBreak') === 'true';
    this.hideSeconds = localStorage.getItem('hideSeconds') === 'true';
    this.pomodoroSession.loadTimerSettings();
  }

  /**
   * Updates settings currently in storage
   */
  updateSettings() {
    localStorage.clear();
    localStorage.setItem('workSessionDuration', this.DOM_ELEMENTS.pomDurationDrop.value);
    localStorage.setItem('shortBreakDuration', this.DOM_ELEMENTS.shortBreakDrop.value);
    localStorage.setItem('longBreakDuration', this.DOM_ELEMENTS.longBreakDrop.value);
    localStorage.setItem('numSessionsBeforeLongBreak', this.DOM_ELEMENTS.pomBeforeBreakDrop.value);
    if (this.DOM_ELEMENTS.pauseBeforeBox.checked) {
      localStorage.setItem('pauseBeforeBreak', true);
      this.pauseBeforeBreak = true;
    } else {
      localStorage.setItem('pauseBeforeBreak', false);
      this.pauseBeforeBreak = false;
    }

    if (this.DOM_ELEMENTS.pauseAfterBox.checked) {
      localStorage.setItem('pauseAfterBreak', true);
      this.pauseAfterBreak = true;
    } else {
      localStorage.setItem('pauseAfterBreak', false);
      this.pauseAfterBreak = false;
    }

    if (this.DOM_ELEMENTS.hideSecondsBox.checked) {
      localStorage.setItem('hideSeconds', true);
      this.hideSeconds = true;
    } else {
      localStorage.setItem('hideSeconds', false);
      this.hideSeconds = false;
    }

    this.loadStoredInputValues();
    this.pomodoroSession.loadTimerSettings();
  }
}

export default Settings;
</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.6.4</a> on Fri Mar 12 2021 04:50:15 GMT+0000 (Coordinated Universal Time) using the Minami theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
